(self.webpackChunkng_new=self.webpackChunkng_new||[]).push([[958],{6958:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AuthModule:()=>it});var o=r(1116),i=r(7569),n=r(9996),s=r(835),a=r(5366),l=r(4345);let c=(()=>{class e{constructor(e,t,r){this.logService=e,this.router=t,this.userService=r}canActivate(){return this.userService.account$.pipe((0,n.U)(e=>void 0===e||(this.logService.info(s.z.Guard,this.constructor.name),this.router.parseUrl("/"))))}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(s.$),a.LFG(i.F0),a.LFG(l.K))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),u=(()=>{class e{constructor(e,t,r){this.logService=e,this.router=t,this.userService=r}canActivate(){const e=this.userService.jwt;return this.userService.account$.pipe((0,n.U)(t=>void 0!==e&&void 0!==t||(this.logService.info(s.z.Guard,this.constructor.name),this.router.parseUrl("/auth"))))}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(s.$),a.LFG(i.F0),a.LFG(l.K))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var d=r(5425),m=r(1772),f=r(878),p=r(1225),g=r(2628),h=r(4689),Z=function(e){return e.Admin="admin",e.Ghost="ghost",e}({}),w=function(e){return e.InvalidEmail="Invalid email",e.InvalidPassword="Invalid password",e.EmailExists="Email already exists",e.EmailConfirmed="Email already confirmed",e.EmailNotFound="Email not found",e.InvalidToken="Invalid token",e.NewPasswordMustBeDifferentFromCurrent="New password must be different from current",e}({});const v={id:42,email:"johndoe@email.com",password:"JohnDoePass123",firstName:"John",lastName:"Doe",isConfirmed:!0,createdAt:new Date("September 22, 2018 15:00:00"),updatedAt:new Date("October 12, 2020 19:00:00"),roles:[Z.Ghost]},b="johndoe.test.token",q=1e3;var A=r(2797),T=r(7173),y=r(1041),x=r(5959),N=r(5416),S=r(4019),I=r(611),$=r(2693);let D=(()=>{class e{constructor(e,t){this.userService=e,this.http=t,this.isUsableWithoutApi=""===m.N.apiUrl}login$(e){return this.isUsableWithoutApi?(e=>{if(e.email.toLowerCase()!==v.email)return(0,f.of)(void 0).pipe((0,g.g)(q),(0,h.w)(()=>(0,p._)(new Error("Invalid email"))));if(e.password!==v.password)return(0,f.of)(void 0).pipe((0,g.g)(q),(0,h.w)(()=>(0,p._)(new Error("Invalid password"))));const t=function(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(r[o[i]]=e[o[i]])}return r}(v,["password"]);return(0,f.of)({jwt:"ey...",account:t}).pipe((0,g.g)(q))})(e).pipe((0,S.b)(e=>this.userService.update(e.account,e.jwt))):this.http.post(`${m.N.apiUrl}/auth/login`,e).pipe((0,S.b)(e=>this.userService.update(e.account,e.jwt)))}register$(e){return this.isUsableWithoutApi?(e=>e.email.toLowerCase()===v.email?(0,f.of)(void 0).pipe((0,g.g)(q),(0,h.w)(()=>(0,p._)(new Error("Email already exists")))):(0,f.of)({jwt:"ey...",account:{id:43,createdAt:new Date,updatedAt:new Date,firstName:e.firstName,lastName:e.lastName,email:e.email,isConfirmed:!1}}).pipe((0,g.g)(q)))(e).pipe((0,S.b)(e=>this.userService.update(e.account,e.jwt))):this.http.post(`${m.N.apiUrl}/auth/register`,e).pipe((0,S.b)(e=>this.userService.update(e.account,e.jwt)))}resendConfirmationEmail$(e){return this.isUsableWithoutApi?(0,f.of)({isSuccess:!0}).pipe((0,g.g)(2e3)):this.http.get(`${m.N.apiUrl}/auth/resend-confirmation-email/${e}`)}confirmEmail$(e){return this.isUsableWithoutApi?this.userService.account$.pipe((0,I.q)(1),(0,h.w)(t=>((e,t)=>{if(void 0===e)return(0,p._)(new Error(w.EmailConfirmed));if(e.isConfirmed)return(0,p._)(new Error(w.EmailConfirmed));if(t!==b)return(0,f.of)(void 0).pipe((0,g.g)(q),(0,h.w)(()=>(0,p._)(new Error(w.InvalidToken))));const r=Object.assign(Object.assign({},v),{isConfirmed:!0});return(0,f.of)({jwt:"ey...",account:r}).pipe((0,g.g)(q))})(t,e)),(0,S.b)(e=>{this.userService.update(e.account,e.jwt)})):this.http.get(`${m.N.apiUrl}/auth/confirm-email/${e}`).pipe((0,S.b)(e=>this.userService.update(e.account,e.jwt)))}forgotPassword$(e){const t=e.toLowerCase();return this.isUsableWithoutApi?(0,f.of)({isProcessed:!0}).pipe((0,g.g)(q)):this.http.get(`${m.N.apiUrl}/auth/forgot-password/${t}`)}resetPassword$(e,t,r){return this.isUsableWithoutApi?((e,t,r)=>t===v.id&&r===b?(0,f.of)({isProcessed:!0}).pipe((0,g.g)(q)):(0,f.of)(void 0).pipe((0,g.g)(q),(0,h.w)(()=>(0,p._)(new Error(w.InvalidToken)))))(0,t,r):this.http.post(`${m.N.apiUrl}/auth/reset-password/${t}/${r}`,e)}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(l.K),a.LFG($.eN))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Y=r(5886),k=r(3070),P=r(9550),J=r(4369),C=r(7307),_=r(2312);function z(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,12),a.qZA())}function Q(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,13),a.qZA())}function O(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,14),a.qZA())}function U(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"button",15),a.NdJ("click",function(){a.CHM(e);const t=a.oxw();return t.isPasswordHidden=!t.isPasswordHidden}),a.TgZ(1,"mat-icon"),a._uU(2),a.qZA(),a.qZA()}if(2&e){const e=a.oxw();a.xp6(2),a.Oqu(e.isPasswordHidden?"visibility_off":"visibility")}}function M(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,16),a.qZA())}function H(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,17),a.qZA())}function E(e,t){1&e&&a._UZ(0,"mat-progress-bar",18)}function R(e,t){1&e&&(a.TgZ(0,"button",19),a.SDv(1,20),a.qZA())}function F(e,t){if(1&e&&(a.TgZ(0,"button",21),a.TgZ(1,"span"),a.SDv(2,22),a.qZA(),a.TgZ(3,"mat-icon"),a._uU(4,"send"),a.qZA(),a.qZA()),2&e){const e=a.oxw();a.Q6J("disabled",!e.formGroup.valid)}}let G=(()=>{class e{constructor(e,t,r,o){this.formBuilder=e,this.authService=t,this.router=r,this.snackbarService=o,this.errorHappens=new a.vpe,this.isLoading=!1,this.isPasswordHidden=!0,this.errorMessage="",this.isDestroyed$=new x.xQ,this.formGroup=this.createFormGroup("change")}get f(){return this.formGroup.controls}ngOnInit(){}ngOnDestroy(){this.isDestroyed$.next(!0),this.isDestroyed$.complete()}onSubmit(){var e,t;return this.isLoading=!0,this.formGroup.disable(),this.isPasswordHidden=!0,this.authService.login$({email:null===(e=this.f.identifier)||void 0===e?void 0:e.value,password:null===(t=this.f.password)||void 0===t?void 0:t.value}).pipe((0,N.R)(this.isDestroyed$)).subscribe(e=>this.router.navigate(["/"]),e=>{this.errorHappens.emit(e.message),this.errorMessage=e.message,this.isLoading=!1,this.formGroup.enable()})}createFormGroup(e,t){const r=this.formBuilder.group({identifier:[void 0,[y.kI.required,y.kI.email]],password:[void 0,[y.kI.required]]},{updateOn:e,validators:this.mustNotBeRejectedValidator()});return void 0!==t&&r.setValue(t),r}mustNotBeRejectedValidator(){return()=>{this.errorMessage===w.InvalidEmail?this.f.identifier.setErrors({mustNotBeRejected:!0}):this.errorMessage===w.InvalidPassword?this.f.password.setErrors({mustNotBeRejected:!0}):""!==this.errorMessage&&this.snackbarService.open(this.errorMessage,"warn"),this.errorMessage=""}}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(y.qu),a.Y36(D),a.Y36(i.F0),a.Y36(Y.o))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-login-form"]],outputs:{errorHappens:"errorHappens"},decls:19,vars:11,consts:function(){let e,t,r,o,i,n,s,a,l,c;return e="Email address",t="Password",r="Toggle password visibility",o="You must fill in this field",i="Please check your identifier",n="Not a valid email",s="You must fill in this field",a="Please check your password",l="Forgot password",c="Submit",[[3,"formGroup","ngSubmit"],["appearance","outline","color","accent",1,"form-field"],e,["matInput","","formControlName","identifier","autocomplete","email","type","email"],[4,"ngIf"],["matInput","","formControlName","password","id","current-password","autocomplete","current-password",3,"type"],t,["type","button","mat-icon-button","","matSuffix","","aria-label",r,3,"click",4,"ngIf"],[1,"button-group","mt-20"],["mode","indeterminate","color","accent",4,"ngIf"],["type","button","mat-button","","color","accent","routerLink","/auth/forgot-password",4,"ngIf"],["mat-raised-button","","class","icon-after rounded","color","accent","type","submit",3,"disabled",4,"ngIf"],o,i,n,["type","button","mat-icon-button","","matSuffix","","aria-label",r,3,"click"],s,a,["mode","indeterminate","color","accent"],["type","button","mat-button","","color","accent","routerLink","/auth/forgot-password"],l,["mat-raised-button","","color","accent","type","submit",1,"icon-after","rounded",3,"disabled"],c]},template:function(e,t){1&e&&(a.TgZ(0,"form",0),a.NdJ("ngSubmit",function(){return t.onSubmit()}),a.TgZ(1,"mat-form-field",1),a.TgZ(2,"mat-label"),a.SDv(3,2),a.qZA(),a._UZ(4,"input",3),a.YNc(5,z,2,0,"mat-error",4),a.YNc(6,Q,2,0,"mat-error",4),a.YNc(7,O,2,0,"mat-error",4),a.qZA(),a.TgZ(8,"mat-form-field",1),a._UZ(9,"input",5),a.TgZ(10,"mat-label"),a.SDv(11,6),a.qZA(),a.YNc(12,U,3,1,"button",7),a.YNc(13,M,2,0,"mat-error",4),a.YNc(14,H,2,0,"mat-error",4),a.qZA(),a.TgZ(15,"div",8),a.YNc(16,E,1,0,"mat-progress-bar",9),a.YNc(17,R,2,0,"button",10),a.YNc(18,F,5,1,"button",11),a.qZA(),a.qZA()),2&e&&(a.Q6J("formGroup",t.formGroup),a.xp6(5),a.Q6J("ngIf",null==t.f.identifier||null==t.f.identifier.errors?null:t.f.identifier.errors.required),a.xp6(1),a.Q6J("ngIf",null==t.f.identifier||null==t.f.identifier.errors?null:t.f.identifier.errors.mustNotBeRejected),a.xp6(1),a.Q6J("ngIf",null==t.f.identifier||null==t.f.identifier.errors?null:t.f.identifier.errors.email),a.xp6(2),a.Q6J("type",t.isPasswordHidden?"password":"text"),a.xp6(3),a.Q6J("ngIf",!t.isLoading),a.xp6(1),a.Q6J("ngIf",null==t.f.password||null==t.f.password.errors?null:t.f.password.errors.required),a.xp6(1),a.Q6J("ngIf",null==t.f.password||null==t.f.password.errors?null:t.f.password.errors.mustNotBeRejected),a.xp6(2),a.Q6J("ngIf",t.isLoading),a.xp6(1),a.Q6J("ngIf",!t.isLoading),a.xp6(1),a.Q6J("ngIf",!t.isLoading))},directives:[y._Y,y.JL,y.sg,k.KE,k.hX,P.Nt,y.Fj,y.JJ,y.u,o.O5,k.TO,J.lW,k.R9,C.Hw,_.pW,i.rH],styles:[".form-field[_ngcontent-%COMP%]{width:100%}.button-group[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}"],changeDetection:0}),e})();function j(e,t){return r=>{const o=r.controls[t];(null===o.errors||o.errors.mustMatch)&&o.setErrors(r.controls[e].value!==o.value?{mustMatch:!0}:null)}}var L=r(2935);let B=(()=>{class e{constructor(e){this.dialogRef=e}ngOnInit(){}onClose(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(L.so))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-confirm-email-dialog"]],decls:8,vars:0,consts:function(){let e,t,r;return e="Check your mailbox",t="A confirmation email has been sent, please check your inbox and follow the link in the email to confirm your registration.",r="Ok",[["matDialogTitle",""],e,t,["mat-dialog-actions",""],["mat-raised-button","","color","accent",1,"rounded",3,"click"],r]},template:function(e,t){1&e&&(a.TgZ(0,"h2",0),a.SDv(1,1),a.qZA(),a.TgZ(2,"mat-dialog-content"),a.TgZ(3,"p"),a.SDv(4,2),a.qZA(),a.qZA(),a.TgZ(5,"div",3),a.TgZ(6,"button",4),a.NdJ("click",function(){return t.onClose()}),a.SDv(7,5),a.qZA(),a.qZA())},directives:[L.uh,L.xY,L.H8,J.lW],styles:[""],changeDetection:0}),e})();function W(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,19),a.qZA())}function V(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,20),a.qZA())}function X(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,21),a.qZA())}function K(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,22),a.qZA())}function ee(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,23),a.qZA())}function te(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,24),a.qZA())}function re(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,25),a.qZA())}function oe(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,26),a.qZA())}function ie(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,27),a.qZA())}function ne(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,28),a.qZA())}function se(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,29),a.qZA())}function ae(e,t){1&e&&a._UZ(0,"mat-progress-bar",30)}function le(e,t){if(1&e&&(a.TgZ(0,"button",31),a.TgZ(1,"span"),a.SDv(2,32),a.qZA(),a.TgZ(3,"mat-icon"),a._uU(4,"send"),a.qZA(),a.qZA()),2&e){const e=a.oxw();a.Q6J("disabled",!e.formGroup.valid)}}let ce=(()=>{class e{constructor(e,t,r,o,i){this.formBuilder=e,this.authService=t,this.router=r,this.snackbarService=o,this.dialog=i,this.errorHappens=new a.vpe,this.isLoading=!1,this.isPasswordHidden=!0,this.errorMessage="",this.isDestroyed$=new x.xQ,this.formGroup=this.createFormGroup("change")}get f(){return this.formGroup.controls}ngOnInit(){}ngOnDestroy(){this.isDestroyed$.next(!0),this.isDestroyed$.complete()}onSubmit(){var e,t,r,o;return this.isLoading=!0,this.formGroup.disable(),this.isPasswordHidden=!0,this.authService.register$({firstName:null===(e=this.f.firstName)||void 0===e?void 0:e.value,lastName:null===(t=this.f.lastName)||void 0===t?void 0:t.value,email:null===(r=this.f.email)||void 0===r?void 0:r.value,password:null===(o=this.f.password)||void 0===o?void 0:o.value}).pipe((0,h.w)(e=>this.dialog.open(B).afterClosed()),(0,N.R)(this.isDestroyed$)).subscribe(e=>this.router.navigate(["/"]),e=>{this.errorHappens.emit(e.message),this.errorMessage=e.message,this.isLoading=!1,this.formGroup.enable()})}onCloseDialog(){return this.dialog.closeAll(),this.router.navigate(["home"])}createFormGroup(e,t){const r=this.formBuilder.group({firstName:[null,[y.kI.required]],lastName:[null,[y.kI.required]],email:[null,[y.kI.required,y.kI.email]],password:[null,[y.kI.required,y.kI.pattern(/^.{8,255}$/)]],confirmPassword:[null,[y.kI.required]]},{updateOn:e,validators:[j("password","confirmPassword"),this.mustNotBeRejectedValidator()]});return void 0!==t&&r.setValue(t),r}mustNotBeRejectedValidator(){return e=>{this.errorMessage===w.EmailExists?e.controls.email.setErrors({mustNotBeRejected:!0}):""!==this.errorMessage&&this.snackbarService.open(this.errorMessage,"warn"),this.errorMessage=""}}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(y.qu),a.Y36(D),a.Y36(i.F0),a.Y36(Y.o),a.Y36(L.uw))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-register-form"]],outputs:{errorHappens:"errorHappens"},decls:42,vars:22,consts:function(){let e,t,r,o,i,n,s,a,l,c,u,d,m,f,p,g,h,Z,w;return e="First name",t="Last name",r="Email address",o="Password",i="Toggle password visibility",n="Confirm password",s="Toggle password visibility",a="You must fill in this field",l="Must contain 2-50 alphanumeric characters",c="You must fill in this field",u="Must contain 2-50 alphanumeric characters",d="You must fill in this field",m="Not a valid email",f="Email is already taken",p="You must fill in this field",g="Must contain 8+ characters",h="Passwords doesn't match",Z="You must fill in this field ",w="Submit",[[3,"formGroup","ngSubmit"],["appearance","outline","color","accent",1,"form-field"],e,["matInput","","formControlName","firstName","color","primary","autocomplete","given-name","required",""],[4,"ngIf"],t,["matInput","","formControlName","lastName","color","primary","autocomplete","family-name","required",""],r,["matInput","","formControlName","email","color","primary","autocomplete","email","type","email","required",""],["matInput","","formControlName","password","id","new-password","autocomplete","new-password","required","",3,"type"],o,["type","button","mat-icon-button","","matSuffix","","aria-label",i,3,"click"],["matInput","","formControlName","confirmPassword","required","",3,"type"],n,["type","button","mat-icon-button","","matSuffix","","aria-label",s,3,"click"],[1,"button-group","mt-20"],["mode","indeterminate","color","accent",4,"ngIf"],[1,"fill-remaining-space"],["mat-raised-button","","class","icon-after rounded","color","accent","type","submit",3,"disabled",4,"ngIf"],a,l,c,u,d,m,f,p,g,h,Z,["mode","indeterminate","color","accent"],["mat-raised-button","","color","accent","type","submit",1,"icon-after","rounded",3,"disabled"],w]},template:function(e,t){1&e&&(a.TgZ(0,"form",0),a.NdJ("ngSubmit",function(){return t.onSubmit()}),a.TgZ(1,"mat-form-field",1),a.TgZ(2,"mat-label"),a.SDv(3,2),a.qZA(),a._UZ(4,"input",3),a.YNc(5,W,2,0,"mat-error",4),a.YNc(6,V,2,0,"mat-error",4),a.qZA(),a.TgZ(7,"mat-form-field",1),a.TgZ(8,"mat-label"),a.SDv(9,5),a.qZA(),a._UZ(10,"input",6),a.YNc(11,X,2,0,"mat-error",4),a.YNc(12,K,2,0,"mat-error",4),a.qZA(),a.TgZ(13,"mat-form-field",1),a.TgZ(14,"mat-label"),a.SDv(15,7),a.qZA(),a._UZ(16,"input",8),a.YNc(17,ee,2,0,"mat-error",4),a.YNc(18,te,2,0,"mat-error",4),a.YNc(19,re,2,0,"mat-error",4),a.qZA(),a.TgZ(20,"mat-form-field",1),a._UZ(21,"input",9),a.TgZ(22,"mat-label"),a.SDv(23,10),a.qZA(),a.TgZ(24,"button",11),a.NdJ("click",function(){return t.isPasswordHidden=!t.isPasswordHidden}),a.TgZ(25,"mat-icon"),a._uU(26),a.qZA(),a.qZA(),a.YNc(27,oe,2,0,"mat-error",4),a.YNc(28,ie,2,0,"mat-error",4),a.qZA(),a.TgZ(29,"mat-form-field",1),a._UZ(30,"input",12),a.TgZ(31,"mat-label"),a.SDv(32,13),a.qZA(),a.TgZ(33,"button",14),a.NdJ("click",function(){return t.isPasswordHidden=!t.isPasswordHidden}),a.TgZ(34,"mat-icon"),a._uU(35),a.qZA(),a.qZA(),a.YNc(36,ne,2,0,"mat-error",4),a.YNc(37,se,2,0,"mat-error",4),a.qZA(),a.TgZ(38,"div",15),a.YNc(39,ae,1,0,"mat-progress-bar",16),a._UZ(40,"span",17),a.YNc(41,le,5,1,"button",18),a.qZA(),a.qZA()),2&e&&(a.Q6J("formGroup",t.formGroup),a.xp6(5),a.Q6J("ngIf",null==t.f.firstName||null==t.f.firstName.errors?null:t.f.firstName.errors.required),a.xp6(1),a.Q6J("ngIf",null==t.f.firstName||null==t.f.firstName.errors?null:t.f.firstName.errors.pattern),a.xp6(5),a.Q6J("ngIf",null==t.f.lastName||null==t.f.lastName.errors?null:t.f.lastName.errors.required),a.xp6(1),a.Q6J("ngIf",null==t.f.lastName||null==t.f.lastName.errors?null:t.f.lastName.errors.pattern),a.xp6(5),a.Q6J("ngIf",null==t.f.email||null==t.f.email.errors?null:t.f.email.errors.required),a.xp6(1),a.Q6J("ngIf",null==t.f.email||null==t.f.email.errors?null:t.f.email.errors.email),a.xp6(1),a.Q6J("ngIf",null==t.f.email||null==t.f.email.errors?null:t.f.email.errors.mustNotBeRejected),a.xp6(2),a.Q6J("type",t.isPasswordHidden?"password":"text"),a.xp6(3),a.uIk("aria-label","isPasswordHidden password")("aria-pressed",t.isPasswordHidden),a.xp6(2),a.Oqu(t.isPasswordHidden?"visibility_off":"visibility"),a.xp6(1),a.Q6J("ngIf",null==t.f.password||null==t.f.password.errors?null:t.f.password.errors.required),a.xp6(1),a.Q6J("ngIf",null==t.f.password||null==t.f.password.errors?null:t.f.password.errors.pattern),a.xp6(2),a.Q6J("type",t.isPasswordHidden?"password":"text"),a.xp6(3),a.uIk("aria-label","isPasswordHidden password")("aria-pressed",t.isPasswordHidden),a.xp6(2),a.hij(" ",t.isPasswordHidden?"visibility_off":"visibility"," "),a.xp6(1),a.Q6J("ngIf",null==t.f.confirmPassword||null==t.f.confirmPassword.errors?null:t.f.confirmPassword.errors.mustMatch),a.xp6(1),a.Q6J("ngIf",null==t.f.confirmPassword||null==t.f.confirmPassword.errors?null:t.f.confirmPassword.errors.required),a.xp6(2),a.Q6J("ngIf",t.isLoading),a.xp6(2),a.Q6J("ngIf",!t.isLoading))},directives:[y._Y,y.JL,y.sg,k.KE,k.hX,P.Nt,y.Fj,y.JJ,y.u,y.Q7,o.O5,J.lW,k.R9,C.Hw,k.TO,_.pW],styles:[".form-field[_ngcontent-%COMP%]{width:100%}.button-group[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}"],changeDetection:0}),e})();function ue(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"mat-card-content",7),a.TgZ(1,"app-login-form",8),a.NdJ("errorHappens",function(t){return a.CHM(e),a.oxw().onErrorHappens(t)}),a.qZA(),a.qZA()}}function de(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"mat-card-content",7),a.TgZ(1,"app-register-form",8),a.NdJ("errorHappens",function(t){return a.CHM(e),a.oxw().onErrorHappens(t)}),a.qZA(),a.qZA()}}function me(e,t){if(1&e&&(a.TgZ(0,"p",9),a.TgZ(1,"b"),a._uU(2,"Test:"),a.qZA(),a._uU(3),a.qZA()),2&e){const e=a.oxw();a.xp6(3),a.AsE(" ",null==e.mockUser?null:e.mockUser.email," / ",null==e.mockUser?null:e.mockUser.password,"")}}const fe=function(e){return{"anime-wobble":e}};let pe=(()=>{class e{constructor(e){this.changeDetectorRef=e,this.errorMessage="",this.isUsableWithoutApi=""===m.N.apiUrl,this.mockUser=v}ngOnInit(){}onErrorHappens(e){this.errorMessage=e,this.changeDetectorRef.detectChanges(),setTimeout(()=>{this.errorMessage=""},500)}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(a.sBO))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-auth"]],decls:8,vars:4,consts:function(){let e,t;return e="Log in",t="Register",[[1,"centred","anime-zoom-in"],[1,"p-0","card-alone",3,"ngClass"],["mat-stretch-tabs","","animationDuration","0ms","color","accent"],["label",e],["matTabContent",""],["label",t],["style","margin: 10px;",4,"ngIf"],[1,"m-0","p-16"],[3,"errorHappens"],[2,"margin","10px"]]},template:function(e,t){1&e&&(a.TgZ(0,"section",0),a.TgZ(1,"mat-card",1),a.TgZ(2,"mat-tab-group",2),a.TgZ(3,"mat-tab",3),a.YNc(4,ue,2,0,"ng-template",4),a.qZA(),a.TgZ(5,"mat-tab",5),a.YNc(6,de,2,0,"ng-template",4),a.qZA(),a.qZA(),a.qZA(),a.YNc(7,me,4,2,"p",6),a.qZA()),2&e&&(a.xp6(1),a.Q6J("ngClass",a.VKq(2,fe,!!t.errorMessage)),a.xp6(6),a.Q6J("ngIf",t.isUsableWithoutApi))},directives:[A.a8,o.mk,T.SP,T.uX,T.Vc,o.O5,A.dn,G,ce],styles:[""],changeDetection:0}),e})();var ge=r(1520),he=r(7672);function Ze(e,t){1&e&&a.GkF(0)}function we(e,t){if(1&e&&(a.ynx(0),a.YNc(1,Ze,1,0,"ng-container",9),a.BQk()),2&e){const e=a.oxw(3),t=a.MAs(5),r=a.MAs(9);a.xp6(1),a.Q6J("ngIf",null==e.account?null:e.account.isConfirmed)("ngIfThen",t)("ngIfElse",r)}}function ve(e,t){if(1&e&&(a.ynx(0),a.YNc(1,we,2,3,"ng-container",8),a.BQk()),2&e){const e=a.oxw(2),t=a.MAs(7);a.xp6(1),a.Q6J("ngIf",e.token)("ngIfElse",t)}}function be(e,t){if(1&e&&(a.TgZ(0,"mat-card",7),a.YNc(1,ve,2,2,"ng-container",8),a.qZA()),2&e){const e=a.oxw(),t=a.MAs(11);a.xp6(1),a.Q6J("ngIf",!e.isAccountAlreadyConfirmed)("ngIfElse",t)}}function qe(e,t){1&e&&a._UZ(0,"mat-spinner",10)}function Ae(e,t){if(1&e&&(a.TgZ(0,"div",11),a.TgZ(1,"mat-icon",12),a._uU(2,"done"),a.qZA(),a.qZA(),a.TgZ(3,"p"),a.SDv(4,13),a.qZA(),a.TgZ(5,"div",14),a._UZ(6,"span",15),a.TgZ(7,"button",16),a.SDv(8,17),a.qZA(),a.qZA()),2&e){const e=a.oxw();a.xp6(4),a.pQV(e.account.firstName),a.QtT(4)}}function Te(e,t){1&e&&a._UZ(0,"mat-progress-bar",23)}function ye(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"button",24),a.NdJ("click",function(){return a.CHM(e),a.oxw(2).onRequestConfirmEmail()}),a.TgZ(1,"span"),a.SDv(2,25),a.qZA(),a.TgZ(3,"mat-icon"),a._uU(4,"send"),a.qZA(),a.qZA()}}function xe(e,t){if(1&e&&(a.TgZ(0,"div",11),a.TgZ(1,"mat-icon",12),a._uU(2,"error_outline"),a.qZA(),a.qZA(),a.TgZ(3,"p"),a.SDv(4,18),a.qZA(),a.TgZ(5,"p"),a.SDv(6,19),a.qZA(),a.TgZ(7,"div",14),a.YNc(8,Te,1,0,"mat-progress-bar",20),a._UZ(9,"span",21),a.YNc(10,ye,5,0,"button",22),a.qZA()),2&e){const e=a.oxw();a.xp6(8),a.Q6J("ngIf",e.isProcessing),a.xp6(2),a.Q6J("ngIf",!e.isProcessing)}}function Ne(e,t){1&e&&a._UZ(0,"mat-progress-bar",23)}function Se(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"button",24),a.NdJ("click",function(){return a.CHM(e),a.oxw(2).onRequestConfirmEmail()}),a.TgZ(1,"span"),a.SDv(2,29),a.qZA(),a.TgZ(3,"mat-icon"),a._uU(4,"send"),a.qZA(),a.qZA()}}function Ie(e,t){if(1&e&&(a.TgZ(0,"div",11),a.TgZ(1,"mat-icon",12),a._uU(2,"error_outline"),a.qZA(),a.qZA(),a.TgZ(3,"p",26),a.SDv(4,27),a.qZA(),a.TgZ(5,"p"),a.SDv(6,28),a.qZA(),a.TgZ(7,"div",14),a.YNc(8,Ne,1,0,"mat-progress-bar",20),a._UZ(9,"span",21),a.YNc(10,Se,5,0,"button",22),a.qZA()),2&e){const e=a.oxw();a.xp6(8),a.Q6J("ngIf",e.isProcessing),a.xp6(2),a.Q6J("ngIf",!e.isProcessing)}}function $e(e,t){1&e&&(a.TgZ(0,"div",11),a.TgZ(1,"mat-icon",12),a._uU(2,"done"),a.qZA(),a.qZA(),a.TgZ(3,"p"),a.SDv(4,30),a.qZA(),a.TgZ(5,"div",14),a._UZ(6,"span",15),a.TgZ(7,"button",16),a.SDv(8,31),a.qZA(),a.qZA())}let De=(()=>{class e{constructor(e,t,r,o,i,n){this.activatedRoute=e,this.changeDetectorRef=t,this.authService=r,this.userService=o,this.dialog=i,this.router=n,this.isLoading=!1,this.isProcessing=!1,this.isAccountAlreadyConfirmed=!1,this.token=void 0,this.account=void 0,this.isDestroyed$=new x.xQ}ngOnInit(){this.userService.account$.pipe((0,N.R)(this.isDestroyed$)).subscribe(e=>{var t,r;return this.isAccountAlreadyConfirmed=null!==(t=null==e?void 0:e.isConfirmed)&&void 0!==t&&t,this.token=null!==(r=this.activatedRoute.snapshot.paramMap.get("token"))&&void 0!==r?r:void 0,void 0===this.token?void 0:this.verifyToken(this.token)}).unsubscribe()}ngOnDestroy(){this.isDestroyed$.next(!0),this.isDestroyed$.complete()}onRequestConfirmEmail(){return this.isProcessing=!0,this.userService.account$.pipe((0,h.w)(e=>{var t;return this.authService.resendConfirmationEmail$(null===(t=e)||void 0===t?void 0:t.email)}),(0,h.w)(e=>this.dialog.open(B).afterClosed()),(0,N.R)(this.isDestroyed$)).subscribe(e=>this.router.navigate(["/"]))}verifyToken(e){return this.isAccountAlreadyConfirmed=!1,this.isLoading=!0,this.authService.confirmEmail$(e).pipe((0,ge.x)(()=>{this.isLoading=!1,this.changeDetectorRef.detectChanges()}),(0,N.R)(this.isDestroyed$)).subscribe(e=>{this.account=e.account,this.changeDetectorRef.detectChanges()},e=>{var t;(null===(t=e)||void 0===t?void 0:t.message)===w.EmailConfirmed&&(this.isAccountAlreadyConfirmed=!0,this.changeDetectorRef.detectChanges())})}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(i.gz),a.Y36(a.sBO),a.Y36(D),a.Y36(l.K),a.Y36(L.uw),a.Y36(i.F0))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-confirm-email"]],decls:12,vars:2,consts:function(){let e,t,r,o,i,n,s,a,l,c;return e="Welcome " + "\ufffd0\ufffd" + " ! Your are now a confirmed user !",t="Continue",r="You have not confirmed your email address, verify your inbox and click on the link in the email to continue.",o="You can request a new verification link if the old one has expired.",i="Resend",n="Could not confirm your address.",s="You can request a new verification link if the old one has expired.",a="Resend",l="Everything is ready, your email address has already been verified.",c="Continue",[[1,"centred"],["class","card-alone",4,"ngIf","ngIfElse"],["loadingTemplate",""],["emailConfirmedTemplate",""],["emailNotConfirmedTemplate",""],["emailConfirmErrorTemplate",""],["alreadyConfirmedEmailTemplate",""],[1,"card-alone"],[4,"ngIf","ngIfElse"],[4,"ngIf","ngIfThen","ngIfElse"],["color","accent","diameter","60",1,"m-16"],[1,"center","pb-16"],[1,"status-icon"],e,[1,"button-group","mt-16"],[1,"fill-remain-space"],["mat-raised-button","","color","accent","routerLink","/",1,"rounded"],t,r,o,["mode","indeterminate","color","accent","class","mt-16",4,"ngIf"],[1,"fill-remaining-space"],["mat-raised-button","","class","icon-after rounded","color","accent",3,"click",4,"ngIf"],["mode","indeterminate","color","accent",1,"mt-16"],["mat-raised-button","","color","accent",1,"icon-after","rounded",3,"click"],i,[1,"center"],n,s,a,l,c]},template:function(e,t){if(1&e&&(a.TgZ(0,"section",0),a.YNc(1,be,2,2,"mat-card",1),a.qZA(),a.YNc(2,qe,1,0,"ng-template",null,2,a.W1O),a.YNc(4,Ae,9,1,"ng-template",null,3,a.W1O),a.YNc(6,xe,11,2,"ng-template",null,4,a.W1O),a.YNc(8,Ie,11,2,"ng-template",null,5,a.W1O),a.YNc(10,$e,9,0,"ng-template",null,6,a.W1O)),2&e){const e=a.MAs(3);a.xp6(1),a.Q6J("ngIf",!t.isLoading)("ngIfElse",e)}},directives:[o.O5,A.a8,he.$g,C.Hw,J.lW,i.rH,_.pW],styles:[".button-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.status-icon[_ngcontent-%COMP%]{font-size:75px;height:75px;width:75px}"],changeDetection:0}),e})(),Ye=(()=>{class e{constructor(e){this.dialogRef=e}ngOnInit(){}onClose(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(L.so))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-forgot-password-dialog"]],decls:8,vars:0,consts:function(){let e,t,r;return e="Check your mailbox",t="If your email address exists in our database, you will receive a password recovery link at your email address in a few minutes.",r="Ok",[["matDialogTitle",""],e,t,["mat-dialog-actions",""],["mat-raised-button","","color","accent",1,"rounded",3,"click"],r]},template:function(e,t){1&e&&(a.TgZ(0,"h2",0),a.SDv(1,1),a.qZA(),a.TgZ(2,"mat-dialog-content"),a.TgZ(3,"p"),a.SDv(4,2),a.qZA(),a.qZA(),a.TgZ(5,"div",3),a.TgZ(6,"button",4),a.NdJ("click",function(){return t.onClose()}),a.SDv(7,5),a.qZA(),a.qZA())},directives:[L.uh,L.xY,L.H8,J.lW],styles:[""],changeDetection:0}),e})();function ke(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,14),a.qZA())}function Pe(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,15),a.qZA())}function Je(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,16),a.qZA())}function Ce(e,t){1&e&&a._UZ(0,"mat-progress-bar",17)}function _e(e,t){1&e&&(a.TgZ(0,"button",18),a.SDv(1,19),a.qZA())}function ze(e,t){if(1&e&&(a.TgZ(0,"button",20),a.TgZ(1,"span"),a.SDv(2,21),a.qZA(),a.TgZ(3,"mat-icon"),a._uU(4,"send"),a.qZA(),a.qZA()),2&e){const e=a.oxw();a.Q6J("disabled",!e.formGroup.valid)}}function Qe(e,t){1&e&&a.GkF(0)}function Oe(e,t){if(1&e&&(a.ynx(0),a.YNc(1,Qe,1,0,"ng-container",7),a.BQk()),2&e){a.oxw();const e=a.MAs(8);a.xp6(1),a.Q6J("ngTemplateOutlet",e)}}function Ue(e,t){1&e&&a.GkF(0)}function Me(e,t){if(1&e&&(a.ynx(0),a.YNc(1,Ue,1,0,"ng-container",7),a.BQk()),2&e){a.oxw();const e=a.MAs(12);a.xp6(1),a.Q6J("ngTemplateOutlet",e)}}function He(e,t){1&e&&a.GkF(0)}function Ee(e,t){if(1&e&&(a.ynx(0),a.YNc(1,He,1,0,"ng-container",7),a.BQk()),2&e){a.oxw();const e=a.MAs(10);a.xp6(1),a.Q6J("ngTemplateOutlet",e)}}function Re(e,t){1&e&&a._UZ(0,"mat-spinner",8)}function Fe(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,23),a.qZA())}function Ge(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,24),a.qZA())}function je(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,25),a.qZA())}function Le(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,26),a.qZA())}function Be(e,t){1&e&&(a.TgZ(0,"mat-error"),a.SDv(1,27),a.qZA())}function We(e,t){1&e&&a._UZ(0,"mat-progress-bar",28)}function Ve(e,t){if(1&e&&(a.TgZ(0,"button",29),a.TgZ(1,"span"),a.SDv(2,30),a.qZA(),a.TgZ(3,"mat-icon"),a._uU(4,"send"),a.qZA(),a.qZA()),2&e){const e=a.oxw(2);a.Q6J("disabled",!e.formGroup.valid)}}function Xe(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"mat-card-title"),a.SDv(1,9),a.qZA(),a.TgZ(2,"mat-card-content",10),a.TgZ(3,"form",11),a.NdJ("ngSubmit",function(){return a.CHM(e),a.oxw().onSubmit()}),a.TgZ(4,"mat-form-field",12),a._UZ(5,"input",13),a.TgZ(6,"mat-label"),a.SDv(7,14),a.qZA(),a.TgZ(8,"button",15),a.NdJ("click",function(){a.CHM(e);const t=a.oxw();return t.isPasswordHidden=!t.isPasswordHidden}),a.TgZ(9,"mat-icon"),a._uU(10),a.qZA(),a.qZA(),a.YNc(11,Fe,2,0,"mat-error",2),a.YNc(12,Ge,2,0,"mat-error",2),a.YNc(13,je,2,0,"mat-error",2),a.qZA(),a.TgZ(14,"mat-form-field",12),a._UZ(15,"input",16),a.TgZ(16,"mat-label"),a.SDv(17,17),a.qZA(),a.TgZ(18,"button",18),a.NdJ("click",function(){a.CHM(e);const t=a.oxw();return t.isPasswordHidden=!t.isPasswordHidden}),a.TgZ(19,"mat-icon"),a._uU(20),a.qZA(),a.qZA(),a.YNc(21,Le,2,0,"mat-error",2),a.YNc(22,Be,2,0,"mat-error",2),a.qZA(),a.TgZ(23,"div",19),a.YNc(24,We,1,0,"mat-progress-bar",20),a._UZ(25,"span",21),a.YNc(26,Ve,5,1,"button",22),a.qZA(),a.qZA(),a.qZA()}if(2&e){const e=a.oxw();a.xp6(3),a.Q6J("formGroup",e.formGroup),a.xp6(2),a.Q6J("type",e.isPasswordHidden?"password":"text"),a.xp6(3),a.uIk("aria-label","isPasswordHidden password")("aria-pressed",e.isPasswordHidden),a.xp6(2),a.Oqu(e.isPasswordHidden?"visibility_off":"visibility"),a.xp6(1),a.Q6J("ngIf",null==e.f.password||null==e.f.password.errors?null:e.f.password.errors.required),a.xp6(1),a.Q6J("ngIf",null==e.f.password||null==e.f.password.errors?null:e.f.password.errors.pattern),a.xp6(1),a.Q6J("ngIf",null==e.f.password||null==e.f.password.errors?null:e.f.password.errors.mustNotBeRejected),a.xp6(2),a.Q6J("type",e.isPasswordHidden?"password":"text"),a.xp6(3),a.uIk("aria-label","isPasswordHidden password")("aria-pressed",e.isPasswordHidden),a.xp6(2),a.hij(" ",e.isPasswordHidden?"visibility_off":"visibility"," "),a.xp6(1),a.Q6J("ngIf",null==e.f.confirmPassword||null==e.f.confirmPassword.errors?null:e.f.confirmPassword.errors.mustMatch),a.xp6(1),a.Q6J("ngIf",null==e.f.confirmPassword||null==e.f.confirmPassword.errors?null:e.f.confirmPassword.errors.required),a.xp6(2),a.Q6J("ngIf",e.isFormSubmitted),a.xp6(2),a.Q6J("ngIf",!e.isFormSubmitted)}}function Ke(e,t){1&e&&a._UZ(0,"mat-progress-bar",28)}function et(e,t){1&e&&(a.TgZ(0,"button",37),a.TgZ(1,"span"),a.SDv(2,38),a.qZA(),a.TgZ(3,"mat-icon"),a._uU(4,"open_in_new"),a.qZA(),a.qZA())}function tt(e,t){if(1&e&&(a.TgZ(0,"div",31),a.TgZ(1,"mat-icon",32),a._uU(2,"error_outline"),a.qZA(),a.qZA(),a.TgZ(3,"p",33),a.SDv(4,34),a.qZA(),a.TgZ(5,"p"),a.SDv(6,35),a.qZA(),a.TgZ(7,"div",19),a.YNc(8,Ke,1,0,"mat-progress-bar",20),a._UZ(9,"span",21),a.YNc(10,et,5,0,"button",36),a.qZA()),2&e){const e=a.oxw();a.xp6(8),a.Q6J("ngIf",e.isFormSubmitted),a.xp6(2),a.Q6J("ngIf",!e.isFormSubmitted)}}function rt(e,t){1&e&&(a.TgZ(0,"div",31),a.TgZ(1,"mat-icon",32),a._uU(2,"done"),a.qZA(),a.qZA(),a.TgZ(3,"p",33),a.SDv(4,39),a.qZA(),a.TgZ(5,"div",19),a._UZ(6,"span",40),a.TgZ(7,"button",41),a.TgZ(8,"span"),a.SDv(9,42),a.qZA(),a.TgZ(10,"mat-icon"),a._uU(11,"open_in_new"),a.qZA(),a.qZA(),a.qZA())}const ot=[{path:"",component:pe,canActivate:[c]},{path:"confirm-email",component:De,canActivate:[u]},{path:"confirm-email/:token",component:De},{path:"forgot-password",component:(()=>{class e{constructor(e,t,r,o,i){this.formBuilder=e,this.authService=t,this.router=r,this.snackbarService=o,this.dialog=i,this.isLoading=!1,this.isPasswordHidden=!0,this.errorMessage="",this.isDestroyed$=new x.xQ,this.formGroup=this.createFormGroup("change")}get f(){return this.formGroup.controls}ngOnInit(){}ngOnDestroy(){this.isDestroyed$.next(!0),this.isDestroyed$.complete()}onSubmit(){var e;return this.isLoading=!0,this.formGroup.disable(),this.authService.forgotPassword$(null===(e=this.f.email)||void 0===e?void 0:e.value).pipe((0,h.w)(e=>this.dialog.open(Ye).afterClosed()),(0,N.R)(this.isDestroyed$)).subscribe(e=>this.router.navigate(["/auth"]),e=>{var t;this.errorMessage=null===(t=e)||void 0===t?void 0:t.message,this.isLoading=!1,this.formGroup.enable()})}createFormGroup(e){return this.formBuilder.group({email:[null,[y.kI.required,y.kI.email]]},{updateOn:e,validators:this.mustNotBeRejectedValidator()})}mustNotBeRejectedValidator(){return()=>{this.errorMessage===w.EmailNotFound?this.f.email.setErrors({mustNotBeRejected:!0}):""!==this.errorMessage&&this.snackbarService.open(this.errorMessage,"warn"),this.errorMessage=""}}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(y.qu),a.Y36(D),a.Y36(i.F0),a.Y36(Y.o),a.Y36(L.uw))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-forgot-password"]],decls:19,vars:7,consts:function(){let e,t,r,o,i,n,s,a;return e="Forgot password",t="Enter your email address to receive instructions on how to change your password.",r="Email address",o="You must fill in this field",i="Not a valid email",n="Please check your email address",s="Sign in",a="Submit",[[1,"centred","anime-zoom-in"],[1,"card-alone"],e,[1,"pt-10"],t,[3,"formGroup","ngSubmit"],["appearance","outline","color","accent",1,"form-field"],r,["matInput","","formControlName","email","color","primary","type","email","autocomplete","email","required",""],[4,"ngIf"],[1,"button-group"],["class","mt-20","mode","indeterminate","color","accent",4,"ngIf"],["type","button","mat-button","","color","accent","routerLink","/auth",4,"ngIf"],["mat-raised-button","","class","icon-after rounded","color","accent","type","submit",3,"disabled",4,"ngIf"],o,i,n,["mode","indeterminate","color","accent",1,"mt-20"],["type","button","mat-button","","color","accent","routerLink","/auth"],s,["mat-raised-button","","color","accent","type","submit",1,"icon-after","rounded",3,"disabled"],a]},template:function(e,t){1&e&&(a.TgZ(0,"section",0),a.TgZ(1,"mat-card",1),a.TgZ(2,"mat-card-title"),a.SDv(3,2),a.qZA(),a.TgZ(4,"p",3),a.SDv(5,4),a.qZA(),a.TgZ(6,"mat-card-content"),a.TgZ(7,"form",5),a.NdJ("ngSubmit",function(){return t.onSubmit()}),a.TgZ(8,"mat-form-field",6),a.TgZ(9,"mat-label"),a.SDv(10,7),a.qZA(),a._UZ(11,"input",8),a.YNc(12,ke,2,0,"mat-error",9),a.YNc(13,Pe,2,0,"mat-error",9),a.YNc(14,Je,2,0,"mat-error",9),a.qZA(),a.TgZ(15,"div",10),a.YNc(16,Ce,1,0,"mat-progress-bar",11),a.YNc(17,_e,2,0,"button",12),a.YNc(18,ze,5,1,"button",13),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&e&&(a.xp6(7),a.Q6J("formGroup",t.formGroup),a.xp6(5),a.Q6J("ngIf",null==t.f.email||null==t.f.email.errors?null:t.f.email.errors.required),a.xp6(1),a.Q6J("ngIf",null==t.f.email||null==t.f.email.errors?null:t.f.email.errors.email),a.xp6(1),a.Q6J("ngIf",null==t.f.email||null==t.f.email.errors?null:t.f.email.errors.mustNotBeRejected),a.xp6(2),a.Q6J("ngIf",t.isLoading),a.xp6(1),a.Q6J("ngIf",!t.isLoading),a.xp6(1),a.Q6J("ngIf",!t.isLoading))},directives:[A.a8,A.n5,A.dn,y._Y,y.JL,y.sg,k.KE,k.hX,P.Nt,y.Fj,y.JJ,y.u,y.Q7,o.O5,k.TO,_.pW,J.lW,i.rH,C.Hw],styles:[".form-field[_ngcontent-%COMP%]{width:100%}.button-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between}"],changeDetection:0}),e})(),canActivate:[c]},{path:"reset-password/:id/:token",component:(()=>{class e{constructor(e,t,r,o,i){this.formBuilder=e,this.authService=t,this.snackbarService=r,this.changeDetectorRef=o,this.activatedRoute=i,this.isFormSubmitted=!1,this.isResetPasswordSucceed=!1,this.isResetPasswordFailed=!1,this.accountId=0,this.token="",this.isPasswordHidden=!0,this.errorMessage="",this.isDestroyed$=new x.xQ,this.formGroup=this.createFormGroup("change")}get f(){return this.formGroup.controls}ngOnInit(){var e,t,r,o,i;return r=this,void 0,i=function*(){const r=null!==(e=this.activatedRoute.snapshot.paramMap.get("id"))&&void 0!==e?e:"";this.accountId=""!==r?parseInt(r,10):0,this.token=null!==(t=this.activatedRoute.snapshot.paramMap.get("token"))&&void 0!==t?t:""},new((o=void 0)||(o=Promise))(function(e,t){function n(e){try{a(i.next(e))}catch(r){t(r)}}function s(e){try{a(i.throw(e))}catch(r){t(r)}}function a(t){var r;t.done?e(t.value):(r=t.value,r instanceof o?r:new o(function(e){e(r)})).then(n,s)}a((i=i.apply(r,[])).next())})}ngOnDestroy(){this.isDestroyed$.next(!0),this.isDestroyed$.complete()}onSubmit(){var e;return this.isFormSubmitted=!0,this.formGroup.disable(),this.isPasswordHidden=!0,this.authService.resetPassword$({newPassword:null===(e=this.f.password)||void 0===e?void 0:e.value},this.accountId,this.token).pipe((0,ge.x)(()=>{this.isFormSubmitted=!1,this.changeDetectorRef.detectChanges()}),(0,N.R)(this.isDestroyed$)).subscribe(e=>this.isResetPasswordSucceed=!0,e=>{var t;this.errorMessage=null===(t=e)||void 0===t?void 0:t.message,this.errorMessage===w.NewPasswordMustBeDifferentFromCurrent?(this.isFormSubmitted=!1,this.formGroup.enable(),this.f.password.setErrors({mustNotBeRejected:!0}),this.errorMessage=""):this.isResetPasswordFailed=!0})}createFormGroup(e,t){const r=this.formBuilder.group({password:[null,[y.kI.required,y.kI.pattern(/^.{8,191}$/)]],confirmPassword:[null,[y.kI.required]]},{updateOn:e,validators:[j("password","confirmPassword"),this.mustNotBeRejectedValidator()]});return void 0!==t&&r.setValue(t),r}mustNotBeRejectedValidator(){return()=>{""!==this.errorMessage&&this.snackbarService.open(this.errorMessage,"warn"),this.errorMessage=""}}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(y.qu),a.Y36(D),a.Y36(Y.o),a.Y36(a.sBO),a.Y36(i.gz))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-reset-password"]],decls:13,vars:3,consts:function(){let e,t,r,o,i,n,s,a,l,c,u,d,m,f,p,g;return e="Set your new password",t="Password",r="Toggle password visibility",o="Confirm password",i="Toggle password visibility",n="You must fill in this field",s="Must contain 8+ characters",a="New password must be different from current",l="Passwords doesn't match",c="You must confirm the password",u="Submit",d="Could not reset your password.",m="You can request a new verification link if the old one has expired.",f="Forgot password",p="You have just changed your password, you can now authenticate yourself.",g="Sign in",[[1,"centred"],[1,"p-20","auth-card"],[4,"ngIf"],["loadingTemplate",""],["setNewPasswordTemplate",""],["resetPasswordFailedTemplate",""],["resetPasswordSuccessTemplate",""],[4,"ngTemplateOutlet"],["color","accent"],e,[1,"pt-10"],[3,"formGroup","ngSubmit"],["appearance","outline","color","accent",1,"form-field"],["matInput","","formControlName","password","autocomplete","new-password","required","",3,"type"],t,["type","button","mat-icon-button","","matSuffix","","aria-label",r,3,"click"],["matInput","","formControlName","confirmPassword","required","",3,"type"],o,["type","button","mat-icon-button","","matSuffix","","aria-label",i,3,"click"],[1,"button-group"],["mode","indeterminate","color","accent",4,"ngIf"],[1,"fill-remaining-space"],["mat-raised-button","","class","icon-after rounded","color","accent","type","submit",3,"disabled",4,"ngIf"],n,s,a,l,c,["mode","indeterminate","color","accent"],["mat-raised-button","","color","accent","type","submit",1,"icon-after","rounded",3,"disabled"],u,[1,"center"],[1,"status-icon"],[1,"center","py-10"],d,m,["mat-raised-button","","class","icon-after rounded","color","accent","routerLink","/auth/forgot-password",4,"ngIf"],["mat-raised-button","","color","accent","routerLink","/auth/forgot-password",1,"icon-after","rounded"],f,p,[1,"fill-remain-space"],["mat-raised-button","","color","accent","routerLink","/auth",1,"icon-after","rounded"],g]},template:function(e,t){1&e&&(a.TgZ(0,"section",0),a.TgZ(1,"mat-card",1),a.YNc(2,Oe,2,1,"ng-container",2),a.YNc(3,Me,2,1,"ng-container",2),a.YNc(4,Ee,2,1,"ng-container",2),a.qZA(),a.qZA(),a.YNc(5,Re,1,0,"ng-template",null,3,a.W1O),a.YNc(7,Xe,27,16,"ng-template",null,4,a.W1O),a.YNc(9,tt,11,2,"ng-template",null,5,a.W1O),a.YNc(11,rt,12,0,"ng-template",null,6,a.W1O)),2&e&&(a.xp6(2),a.Q6J("ngIf",!t.isResetPasswordFailed&&!t.isResetPasswordSucceed),a.xp6(1),a.Q6J("ngIf",t.isResetPasswordSucceed),a.xp6(1),a.Q6J("ngIf",t.isResetPasswordFailed))},directives:[A.a8,o.O5,o.tP,he.$g,A.n5,A.dn,y._Y,y.JL,y.sg,k.KE,P.Nt,y.Fj,y.JJ,y.u,y.Q7,k.hX,J.lW,k.R9,C.Hw,k.TO,_.pW,i.rH],styles:[".auth-card[_ngcontent-%COMP%]{max-width:400px}.status-icon[_ngcontent-%COMP%]{font-size:75px;height:75px;width:75px}.form-field[_ngcontent-%COMP%]{width:100%}.button-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between}"],changeDetection:0}),e})()}];let it=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({imports:[[o.ez,i.Bz.forChild(ot),d.m]]}),e})()}}]);